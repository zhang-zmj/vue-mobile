(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d4d9fe0"],{a38c:function(t,e,c){"use strict";c.r(e);c("b0c0");var n=c("7a23"),r=function(t){return Object(n["F"])("data-v-45e9bb03"),t=t(),Object(n["D"])(),t},a={class:"create-order"},o=Object(n["k"])(" 定单预览 "),u={class:"address-wrap"},s={class:"address"},i={class:"good"},d={class:"good-img"},b={alt:""},l={class:"good-desc"},j={class:"good-title"},O={class:"good-btn"},f={class:"price"},p=r((function(){return Object(n["j"])("small",null,"¥",-1)})),h=Object(n["k"])(" 商品金额 "),v=Object(n["k"])(" 支付宝二维码"),g=r((function(){return Object(n["j"])("br",null,null,-1)})),m=Object(n["k"])(" 微信二维码"),w=r((function(){return Object(n["j"])("br",null,null,-1)}));function y(t,e,c,r,y,_){var k=Object(n["K"])("nav-bar"),C=Object(n["K"])("van-icon"),K=Object(n["K"])("van-submit-bar"),N=Object(n["K"])("van-image"),U=Object(n["K"])("van-grid-item"),I=Object(n["K"])("van-grid"),L=Object(n["K"])("van-popup"),P=Object(n["L"])("lazy");return Object(n["C"])(),Object(n["i"])("div",a,[Object(n["l"])(k,{class:"nav-bar"},{default:Object(n["U"])((function(){return[o]})),_:1}),Object(n["j"])("div",u,[Object(n["j"])("div",{class:"name",onClick:e[0]||(e[0]=function(){return r.goTo&&r.goTo.apply(r,arguments)})},[Object(n["j"])("span",null,Object(n["O"])(t.address.name),1),Object(n["j"])("span",null,Object(n["O"])(t.address.phone),1)]),Object(n["j"])("div",s,Object(n["O"])(t.address.province)+" "+Object(n["O"])(t.address.city)+" "+Object(n["O"])(t.address.county)+" "+Object(n["O"])(t.address.address),1),Object(n["l"])(C,{class:"arrow",name:"arrow"})]),Object(n["j"])("div",i,[(Object(n["C"])(!0),Object(n["i"])(n["a"],null,Object(n["I"])(t.cartList,(function(t,e){return Object(n["C"])(),Object(n["i"])("div",{class:"good-item",key:e},[Object(n["j"])("div",d,[Object(n["V"])(Object(n["j"])("img",b,null,512),[[P,t.goods.cover_url]])]),Object(n["j"])("div",l,[Object(n["j"])("div",j,[Object(n["j"])("span",null,Object(n["O"])(t.goods.title),1),Object(n["j"])("span",null,"x"+Object(n["O"])(t.num),1)]),Object(n["j"])("div",O,[Object(n["j"])("div",f,[p,Object(n["k"])(" "+Object(n["O"])(t.goods.price+".00"),1)])])])])})),128))]),Object(n["l"])(K,{class:"submit-all",price:100*r.total,"button-text":"生成订单",onSubmit:r.handleCreateOrder},{default:Object(n["U"])((function(){return[h]})),_:1},8,["price","onSubmit"]),Object(n["l"])(L,{closeable:"","close-on-click-overlay":!1,show:t.showPay,"onUpdate:show":e[1]||(e[1]=function(e){return t.showPay=e}),position:"bottom",style:{height:"40%"},onClose:r.close},{default:Object(n["U"])((function(){return[Object(n["l"])(I,{border:!1,"column-num":2},{default:Object(n["U"])((function(){return[Object(n["l"])(U,null,{default:Object(n["U"])((function(){return[v,g,Object(n["l"])(N,{width:"150",height:"150",src:t.aliyun},null,8,["src"])]})),_:1}),Object(n["l"])(U,null,{default:Object(n["U"])((function(){return[m,w,Object(n["l"])(N,{width:"150",height:"150",src:t.wechat},null,8,["src"])]})),_:1})]})),_:1})]})),_:1},8,["show","onClose"])])}var _=c("5530"),k=(c("e7e5"),c("d399")),C=(c("4de4"),c("159b"),c("a7ac")),K=c("e05b"),N=c("6c02"),U=c("5502"),I={components:{NavBar:C["a"]},setup:function(){var t=Object(N["d"])(),e=(Object(N["c"])(),Object(U["b"])()),c=Object(n["G"])({cartList:[],address:{},showPay:!1,orderNo:"",aliyun:"",wechat:""}),r=function(){k["a"].loading({message:"加载中...",forbidClick:!0}),Object(K["e"])().then((function(t){var e=t.address.filter((function(t){return"1"==t.is_default}));0==e.length?c.address={address:"还没有设置默认地址，请选择或填写地址信息"}:c.address=e[0],c.cartList=t.carts,k["a"].clear()}))};Object(n["z"])((function(){r()}));var a=function(){t.push({path:"/address"})},o=function(){var n={address_id:c.address.id};Object(K["b"])(n).then((function(n){Object(k["a"])("创建定单成功"),e.dispatch("updateCart"),c.showPay=!0,c.orderNo=n.id,Object(K["f"])(c.orderNo,{type:"aliyun"}).then((function(t){c.aliyun=t.qr_code_url,c.wechat=t.qr_code_url,console.log("创建支付的接口",t)}));var r=setInterval((function(){Object(K["g"])(c.orderNo).then((function(e){"2"==e&&(clearInterval(r),t.push({path:"/orderdetail",query:{id:c.orderNo}}))}))}),2e3)}))},u=function(){t.push({path:"/orderdetail",query:{id:c.orderNo}})},s=Object(n["e"])((function(){var t=0;return c.cartList.forEach((function(e){t+=parseInt(e.num)*parseFloat(e.goods.price)})),t}));return Object(_["a"])(Object(_["a"])({},Object(n["P"])(c)),{},{goTo:a,handleCreateOrder:o,close:u,total:s})}},L=(c("b3d8"),c("6b0d")),P=c.n(L);const S=P()(I,[["render",y],["__scopeId","data-v-45e9bb03"]]);e["default"]=S},b0c0:function(t,e,c){var n=c("83ab"),r=c("5e77").EXISTS,a=c("9bf2").f,o=Function.prototype,u=o.toString,s=/^\s*function ([^ (]*)/,i="name";n&&!r&&a(o,i,{configurable:!0,get:function(){try{return u.call(this).match(s)[1]}catch(t){return""}}})},b3d8:function(t,e,c){"use strict";c("f67c")},e05b:function(t,e,c){"use strict";c.d(e,"b",(function(){return r})),c.d(e,"e",(function(){return a})),c.d(e,"f",(function(){return o})),c.d(e,"g",(function(){return u})),c.d(e,"d",(function(){return s})),c.d(e,"c",(function(){return i})),c.d(e,"a",(function(){return d}));var n=c("1bab");function r(t){return Object(n["a"])({url:"/api/orders",method:"post",params:t})}function a(){return Object(n["a"])({url:"/api/orders/preview"})}function o(t,e){return Object(n["a"])({url:"/api/orders/".concat(t,"/pay"),params:e})}function u(t){return Object(n["a"])({url:"/api/orders/".concat(t,"/status")})}function s(t){return Object(n["a"])({url:"/api/orders",method:"get",params:t})}function i(t){return Object(n["a"])({url:"/api/orders/".concat(t),params:{include:"user,orderDetails.goods"}})}function d(t){return Object(n["a"])({url:"/api/orders/".concat(t,"/confirm"),method:"patch"})}},f67c:function(t,e,c){}}]);
//# sourceMappingURL=chunk-7d4d9fe0.a227e9e0.js.map