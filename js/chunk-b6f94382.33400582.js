(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b6f94382"],{1703:function(t,e,n){},"2fcb":function(t,e,n){},"5a4f":function(t,e,n){"use strict";n.r(e);var c=n("7a23"),o=function(t){return Object(c["E"])("data-v-03435415"),t=t(),Object(c["C"])(),t},a={class:"order-detail-box"},r=Object(c["j"])(" 定单详情 "),l={class:"order-status"},i={class:"status-item"},u=o((function(){return Object(c["i"])("label",null,"订单状态：",-1)})),s={class:"status-item"},b=o((function(){return Object(c["i"])("label",null,"订单编号：",-1)})),d={class:"status-item"},O=o((function(){return Object(c["i"])("label",null,"下单时间：",-1)})),f=Object(c["j"])("去支付"),j=Object(c["j"])("确认订单"),m={class:"order-price"},p={class:"price-item"},g=o((function(){return Object(c["i"])("label",null,"商品金额：",-1)})),h=o((function(){return Object(c["i"])("div",{class:"price-item"},[Object(c["i"])("label",null,"配送方式："),Object(c["i"])("span",null,"普通快递")],-1)})),v=o((function(){return Object(c["i"])("div",{style:{width:"100%",height:"50px"}},null,-1)})),k={style:{width:"90%",margin:"0 auto",padding:"50px 0"}},w=Object(c["j"])(" 支付宝二维码"),y=o((function(){return Object(c["i"])("br",null,null,-1)})),B=Object(c["j"])(" 微信二维码"),C=o((function(){return Object(c["i"])("br",null,null,-1)}));function S(t,e,n,o,S,x){var _=Object(c["J"])("nav-bar"),P=Object(c["J"])("van-button"),N=Object(c["J"])("van-card"),J=Object(c["J"])("van-image"),T=Object(c["J"])("van-grid-item"),D=Object(c["J"])("van-grid"),F=Object(c["J"])("van-popup");return Object(c["B"])(),Object(c["h"])("div",a,[Object(c["k"])(_,{class:"nav-bar"},{default:Object(c["S"])((function(){return[r]})),_:1}),Object(c["i"])("div",l,[Object(c["i"])("div",i,[u,Object(c["i"])("span",null,Object(c["M"])(o.statusString),1)]),Object(c["i"])("div",s,[b,Object(c["i"])("span",null,Object(c["M"])(t.detail.order_no),1)]),Object(c["i"])("div",d,[O,Object(c["i"])("span",null,Object(c["M"])(t.detail.created_at),1)]),1==t.detail.status?(Object(c["B"])(),Object(c["f"])(P,{key:0,onClick:o.showPayFn,style:{"margin-bottom":"10px"},color:"#1baeae",block:""},{default:Object(c["S"])((function(){return[f]})),_:1},8,["onClick"])):Object(c["g"])("",!0),2==t.detail.status?(Object(c["B"])(),Object(c["f"])(P,{key:1,onClick:o.handleConfirmOrder,block:""},{default:Object(c["S"])((function(){return[j]})),_:1},8,["onClick"])):Object(c["g"])("",!0)]),Object(c["i"])("div",m,[Object(c["i"])("div",p,[g,Object(c["i"])("span",null,"¥ "+Object(c["M"])(o.total+".00"),1)]),h]),(Object(c["B"])(!0),Object(c["h"])(c["a"],null,Object(c["H"])(t.detail.orderDetails.data,(function(t){return Object(c["B"])(),Object(c["f"])(N,{key:t.id,num:t.num,price:t.price+".00",desc:"全场包邮",title:t.goods.title,thumb:t.goods.cover_url},null,8,["num","price","title","thumb"])})),128)),v,Object(c["k"])(F,{show:t.showPay,"onUpdate:show":e[0]||(e[0]=function(e){return t.showPay=e}),position:"bottom",style:{height:"40%"}},{default:Object(c["S"])((function(){return[Object(c["i"])("div",k,[Object(c["k"])(D,{border:!1,"column-num":2},{default:Object(c["S"])((function(){return[Object(c["k"])(T,{text:"支付宝"},{default:Object(c["S"])((function(){return[w,y,Object(c["k"])(J,{width:"150",height:"150",src:t.aliyun},null,8,["src"])]})),_:1}),Object(c["k"])(T,{text:"微信支付"},{default:Object(c["S"])((function(){return[B,C,Object(c["k"])(J,{width:"150",height:"150",src:t.wechat},null,8,["src"])]})),_:1})]})),_:1})])]})),_:1},8,["show"])])}var x,_=n("5530"),P=(n("68ef"),n("d4ef"),n("cb51"),n("3743"),n("e3b3"),n("bc1b"),n("1703"),n("a71a"),n("4d75"),n("2fcb"),n("f344")),N=n("c199"),J=n("1da4"),T=n("fe7e"),D=n("f691"),F=n("7e3e"),H=n("8da3"),A=n("b1d2"),I=n("8405"),M=n("f827"),q=n("e41f"),z=n("b650"),U=n("a6cd"),[E,L]=Object(T["a"])("action-bar"),$=Symbol(E),G=Object(c["l"])({name:E,props:{safeAreaInsetBottom:D["g"]},setup(t,{slots:e}){var{linkChildren:n}=Object(U["a"])($);return n(),()=>Object(c["k"])("div",{class:[L(),{"van-safe-area-bottom":t.safeAreaInsetBottom}]},[null==e.default?void 0:e.default()])}}),K=Object(N["a"])(G),Q=n("6ba6"),R=n("4eda"),V=n("b070"),[W,X]=Object(T["a"])("action-bar-button"),Y=Object(c["l"])({name:W,props:Object(P["a"])({},V["b"],{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean}),setup(t,{slots:e}){var n=Object(V["c"])(),{parent:o,index:a}=Object(Q["a"])($),r=Object(c["d"])(()=>{if(o){var t=o.children[a.value-1];return!(t&&"isButton"in t)}}),l=Object(c["d"])(()=>{if(o){var t=o.children[a.value+1];return!(t&&"isButton"in t)}});return Object(R["a"])({isButton:!0}),()=>{var{type:o,icon:a,text:i,color:u,loading:s,disabled:b}=t;return Object(c["k"])(z["a"],{class:X([o,{last:l.value,first:r.value}]),size:"large",type:o,icon:a,color:u,loading:s,disabled:b,onClick:n},{default:()=>[e.default?e.default():i]})}}}),Z=Object(N["a"])(Y),[tt,et,nt]=Object(T["a"])("dialog"),ct=[...M["a"],"transition","closeOnPopstate"],ot=Object(c["l"])({name:tt,props:Object(P["a"])({},M["b"],{title:String,theme:String,width:D["f"],message:[String,Function],callback:Function,allowHtml:Boolean,className:D["h"],transition:Object(D["e"])("van-dialog-bounce"),messageAlign:String,closeOnPopstate:D["g"],showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showConfirmButton:D["g"],closeOnClickOverlay:Boolean}),emits:["confirm","cancel","update:show"],setup(t,{emit:e,slots:n}){var o=Object(c["F"])({confirm:!1,cancel:!1}),a=t=>e("update:show",t),r=e=>{a(!1),null==t.callback||t.callback(e)},l=n=>()=>{t.show&&(e(n),t.beforeClose?(o[n]=!0,Object(F["a"])(t.beforeClose,{args:[n],done(){r(n),o[n]=!1},canceled(){o[n]=!1}})):r(n))},i=l("cancel"),u=l("confirm"),s=()=>{var e=n.title?n.title():t.title;if(e)return Object(c["k"])("div",{class:et("header",{isolated:!t.message&&!n.default})},[e])},b=e=>{var{message:n,allowHtml:o,messageAlign:a}=t,r=et("message",{"has-title":e,[a]:a}),l=Object(H["b"])(n)?n():n;return o&&"string"===typeof l?Object(c["k"])("div",{class:r,innerHTML:l},null):Object(c["k"])("div",{class:r},[l])},d=()=>{if(n.default)return Object(c["k"])("div",{class:et("content")},[n.default()]);var{title:e,message:o,allowHtml:a}=t;if(o){var r=!(!e&&!n.title);return Object(c["k"])("div",{key:a?1:0,class:et("content",{isolated:!r})},[b(r)])}},O=()=>Object(c["k"])("div",{class:[A["d"],et("footer")]},[t.showCancelButton&&Object(c["k"])(z["a"],{size:"large",text:t.cancelButtonText||nt("cancel"),class:et("cancel"),style:{color:t.cancelButtonColor},loading:o.cancel,onClick:i},null),t.showConfirmButton&&Object(c["k"])(z["a"],{size:"large",text:t.confirmButtonText||nt("confirm"),class:[et("confirm"),{[A["b"]]:t.showCancelButton}],style:{color:t.confirmButtonColor},loading:o.confirm,onClick:u},null)]),f=()=>Object(c["k"])(K,{class:et("footer")},{default:()=>[t.showCancelButton&&Object(c["k"])(Z,{type:"warning",text:t.cancelButtonText||nt("cancel"),class:et("cancel"),color:t.cancelButtonColor,loading:o.cancel,onClick:i},null),t.showConfirmButton&&Object(c["k"])(Z,{type:"danger",text:t.confirmButtonText||nt("confirm"),class:et("confirm"),color:t.confirmButtonColor,loading:o.confirm,onClick:u},null)]}),j=()=>n.footer?n.footer():"round-button"===t.theme?f():O();return()=>{var{width:e,title:n,theme:o,message:r,className:l}=t;return Object(c["k"])(q["a"],Object(c["r"])({role:"dialog",class:[et([o]),l],style:{width:Object(I["b"])(e)},"aria-labelledby":n||r,"onUpdate:show":a},Object(P["e"])(t,ct)),{default:()=>[s(),d(),j()]})}}});function at(){var t={setup(){var{state:t,toggle:e}=Object(J["b"])();return()=>Object(c["k"])(ot,Object(c["r"])(t,{"onUpdate:show":e}),null)}};({instance:x}=Object(J["a"])(t))}function rt(t){return P["c"]?new Promise((e,n)=>{x||at(),x.open(Object(P["a"])({},rt.currentOptions,t,{callback:t=>{("confirm"===t?e:n)(t)}}))}):Promise.resolve()}rt.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1},rt.currentOptions=Object(P["a"])({},rt.defaultOptions),rt.alert=rt,rt.confirm=t=>rt(Object(P["a"])({showCancelButton:!0},t)),rt.close=()=>{x&&x.toggle(!1)},rt.setDefaultOptions=t=>{Object(P["a"])(rt.currentOptions,t)},rt.resetDefaultOptions=()=>{rt.currentOptions=Object(P["a"])({},rt.defaultOptions)},rt.Component=Object(N["a"])(ot),rt.install=t=>{t.use(rt.Component),t.config.globalProperties.$dialog=rt};var lt=rt,it=(n("e7e5"),n("d399")),ut=(n("159b"),n("a7ac")),st=n("e05b"),bt=n("6c02"),dt={name:"OrderDetail",components:{NavBar:ut["a"]},setup:function(){var t=Object(bt["c"])(),e=Object(bt["d"])(),n=Object(c["F"])({orderNo:"",detail:{orderDetails:{data:[]},status:0},showPay:!1,aliyun:"",wechat:""}),o=function(){var e=t.query.id;n.orderNo=e,Object(st["c"])(e).then((function(t){console.log(t),n.detail=t}))};Object(c["y"])((function(){it["a"].loading({message:"加载中...",forbidClick:!0}),o(),it["a"].clear()}));var a=Object(c["d"])((function(){var t=["","已下单","已支付","等待发货","确认收货","已过期"];return t[n.detail.status]})),r=Object(c["d"])((function(){var t=0;return n.detail.orderDetails.data.forEach((function(e){t+=e.num*e.price})),t})),l=function(){n.showPay=!0,Object(st["f"])(n.orderNo,{type:"aliyun"}).then((function(t){n.aliyun=t.qr_code_url,n.wechat=t.qr_code_url}));var t=setInterval((function(){Object(st["g"])(n.orderNo).then((function(c){console.log(c),"2"==c&&(clearInterval(t),n.showPay=!1,e.push({path:"/orderdetail",query:{id:n.orderNo}}))}))}),2e3)},i=function(){lt.confirm({title:"是否确认订单"}).then((function(){Object(st["a"])(n.orderNo).then((function(t){Object(it["a"])("确认成功"),o()}))})).catch((function(){}))},u=function(){lt.close()};return Object(_["a"])(Object(_["a"])({},Object(c["N"])(n)),{},{statusString:a,total:r,showPayFn:l,handleConfirmOrder:i,close:u})}},Ot=(n("6d00"),n("6b0d")),ft=n.n(Ot);const jt=ft()(dt,[["render",S],["__scopeId","data-v-03435415"]]);e["default"]=jt},"6d00":function(t,e,n){"use strict";n("e384")},d4ef:function(t,e,n){},e05b:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return r})),n.d(e,"g",(function(){return l})),n.d(e,"d",(function(){return i})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return s}));var c=n("1bab");function o(t){return Object(c["a"])({url:"/api/orders",method:"post",params:t})}function a(){return Object(c["a"])({url:"/api/orders/preview"})}function r(t,e){return Object(c["a"])({url:"/api/orders/".concat(t,"/pay"),params:e})}function l(t){return Object(c["a"])({url:"/api/orders/".concat(t,"/status")})}function i(t){return Object(c["a"])({url:"/api/orders",method:"get",params:t})}function u(t){return Object(c["a"])({url:"/api/orders/".concat(t),params:{include:"user,orderDetails.goods"}})}function s(t){return Object(c["a"])({url:"/api/orders/".concat(t,"/confirm"),method:"patch"})}},e384:function(t,e,n){}}]);
//# sourceMappingURL=chunk-b6f94382.33400582.js.map