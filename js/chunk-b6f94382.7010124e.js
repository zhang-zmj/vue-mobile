(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b6f94382"],{1703:function(t,e,n){},"2fcb":function(t,e,n){},"5a4f":function(t,e,n){"use strict";n.r(e);var c=n("7a23"),o=function(t){return Object(c["F"])("data-v-03435415"),t=t(),Object(c["D"])(),t},a={class:"order-detail-box"},l=Object(c["k"])(" 定单详情 "),r={class:"order-status"},i={class:"status-item"},u=o((function(){return Object(c["j"])("label",null,"订单状态：",-1)})),s={class:"status-item"},b=o((function(){return Object(c["j"])("label",null,"订单编号：",-1)})),d={class:"status-item"},O=o((function(){return Object(c["j"])("label",null,"下单时间：",-1)})),j=Object(c["k"])("去支付"),f=Object(c["k"])("确认订单"),m={class:"order-price"},p={class:"price-item"},g=o((function(){return Object(c["j"])("label",null,"商品金额：",-1)})),h=o((function(){return Object(c["j"])("div",{class:"price-item"},[Object(c["j"])("label",null,"配送方式："),Object(c["j"])("span",null,"普通快递")],-1)})),v=o((function(){return Object(c["j"])("div",{style:{width:"100%",height:"50px"}},null,-1)})),w={style:{width:"90%",margin:"0 auto",padding:"50px 0"}},C=Object(c["k"])(" 支付宝二维码"),y=o((function(){return Object(c["j"])("br",null,null,-1)})),B=Object(c["k"])(" 微信二维码"),k=o((function(){return Object(c["j"])("br",null,null,-1)}));function x(t,e,n,o,x,S){var _=Object(c["K"])("nav-bar"),P=Object(c["K"])("van-button"),N=Object(c["K"])("van-card"),U=Object(c["K"])("van-image"),T=Object(c["K"])("van-grid-item"),D=Object(c["K"])("van-grid"),K=Object(c["K"])("van-popup");return Object(c["C"])(),Object(c["i"])("div",a,[Object(c["l"])(_,{class:"nav-bar"},{default:Object(c["U"])((function(){return[l]})),_:1}),Object(c["j"])("div",r,[Object(c["j"])("div",i,[u,Object(c["j"])("span",null,Object(c["O"])(o.statusString),1)]),Object(c["j"])("div",s,[b,Object(c["j"])("span",null,Object(c["O"])(t.detail.order_no),1)]),Object(c["j"])("div",d,[O,Object(c["j"])("span",null,Object(c["O"])(t.detail.created_at),1)]),1==t.detail.status?(Object(c["C"])(),Object(c["g"])(P,{key:0,onClick:o.showPayFn,style:{"margin-bottom":"10px"},color:"#1baeae",block:""},{default:Object(c["U"])((function(){return[j]})),_:1},8,["onClick"])):Object(c["h"])("",!0),2==t.detail.status?(Object(c["C"])(),Object(c["g"])(P,{key:1,onClick:o.handleConfirmOrder,block:""},{default:Object(c["U"])((function(){return[f]})),_:1},8,["onClick"])):Object(c["h"])("",!0)]),Object(c["j"])("div",m,[Object(c["j"])("div",p,[g,Object(c["j"])("span",null,"¥ "+Object(c["O"])(o.total+".00"),1)]),h]),(Object(c["C"])(!0),Object(c["i"])(c["a"],null,Object(c["I"])(t.detail.orderDetails.data,(function(t){return Object(c["C"])(),Object(c["g"])(N,{key:t.id,num:t.num,price:t.price+".00",desc:"全场包邮",title:t.goods.title,thumb:t.goods.cover_url},null,8,["num","price","title","thumb"])})),128)),v,Object(c["l"])(K,{show:t.showPay,"onUpdate:show":e[0]||(e[0]=function(e){return t.showPay=e}),position:"bottom",style:{height:"40%"}},{default:Object(c["U"])((function(){return[Object(c["j"])("div",w,[Object(c["l"])(D,{border:!1,"column-num":2},{default:Object(c["U"])((function(){return[Object(c["l"])(T,{text:"支付宝"},{default:Object(c["U"])((function(){return[C,y,Object(c["l"])(U,{width:"150",height:"150",src:t.aliyun},null,8,["src"])]})),_:1}),Object(c["l"])(T,{text:"微信支付"},{default:Object(c["U"])((function(){return[B,k,Object(c["l"])(U,{width:"150",height:"150",src:t.wechat},null,8,["src"])]})),_:1})]})),_:1})])]})),_:1},8,["show"])])}var S,_=n("5530"),P=(n("68ef"),n("d4ef"),n("cb51"),n("3743"),n("e3b3"),n("bc1b"),n("1703"),n("a71a"),n("4d75"),n("2fcb"),n("f344")),N=n("c199"),U=n("1da4"),T=n("fe7e"),D=n("f691"),K=n("7e3e"),I=n("8da3"),A=n("b1d2"),F=n("8405"),H=n("f827"),q=n("e41f"),z=n("b650"),G=n("a6cd"),[J,E]=Object(T["a"])("action-bar"),L=Symbol(J),M=Object(c["m"])({name:J,props:{safeAreaInsetBottom:D["g"]},setup(t,{slots:e}){var{linkChildren:n}=Object(G["a"])(L);return n(),()=>Object(c["l"])("div",{class:[E(),{"van-safe-area-bottom":t.safeAreaInsetBottom}]},[null==e.default?void 0:e.default()])}}),$=Object(N["a"])(M),Q=n("6ba6"),R=n("4eda"),V=n("b070"),[W,X]=Object(T["a"])("action-bar-button"),Y=Object(c["m"])({name:W,props:Object(P["a"])({},V["b"],{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean}),setup(t,{slots:e}){var n=Object(V["c"])(),{parent:o,index:a}=Object(Q["a"])(L),l=Object(c["e"])(()=>{if(o){var t=o.children[a.value-1];return!(t&&"isButton"in t)}}),r=Object(c["e"])(()=>{if(o){var t=o.children[a.value+1];return!(t&&"isButton"in t)}});return Object(R["a"])({isButton:!0}),()=>{var{type:o,icon:a,text:i,color:u,loading:s,disabled:b}=t;return Object(c["l"])(z["a"],{class:X([o,{last:r.value,first:l.value}]),size:"large",type:o,icon:a,color:u,loading:s,disabled:b,onClick:n},{default:()=>[e.default?e.default():i]})}}}),Z=Object(N["a"])(Y),[tt,et,nt]=Object(T["a"])("dialog"),ct=[...H["a"],"transition","closeOnPopstate"],ot=Object(c["m"])({name:tt,props:Object(P["a"])({},H["b"],{title:String,theme:String,width:D["f"],message:[String,Function],callback:Function,allowHtml:Boolean,className:D["h"],transition:Object(D["e"])("van-dialog-bounce"),messageAlign:String,closeOnPopstate:D["g"],showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showConfirmButton:D["g"],closeOnClickOverlay:Boolean}),emits:["confirm","cancel","update:show"],setup(t,{emit:e,slots:n}){var o=Object(c["G"])({confirm:!1,cancel:!1}),a=t=>e("update:show",t),l=e=>{a(!1),null==t.callback||t.callback(e)},r=n=>()=>{t.show&&(e(n),t.beforeClose?(o[n]=!0,Object(K["a"])(t.beforeClose,{args:[n],done(){l(n),o[n]=!1},canceled(){o[n]=!1}})):l(n))},i=r("cancel"),u=r("confirm"),s=()=>{var e=n.title?n.title():t.title;if(e)return Object(c["l"])("div",{class:et("header",{isolated:!t.message&&!n.default})},[e])},b=e=>{var{message:n,allowHtml:o,messageAlign:a}=t,l=et("message",{"has-title":e,[a]:a}),r=Object(I["b"])(n)?n():n;return o&&"string"===typeof r?Object(c["l"])("div",{class:l,innerHTML:r},null):Object(c["l"])("div",{class:l},[r])},d=()=>{if(n.default)return Object(c["l"])("div",{class:et("content")},[n.default()]);var{title:e,message:o,allowHtml:a}=t;if(o){var l=!(!e&&!n.title);return Object(c["l"])("div",{key:a?1:0,class:et("content",{isolated:!l})},[b(l)])}},O=()=>Object(c["l"])("div",{class:[A["d"],et("footer")]},[t.showCancelButton&&Object(c["l"])(z["a"],{size:"large",text:t.cancelButtonText||nt("cancel"),class:et("cancel"),style:{color:t.cancelButtonColor},loading:o.cancel,onClick:i},null),t.showConfirmButton&&Object(c["l"])(z["a"],{size:"large",text:t.confirmButtonText||nt("confirm"),class:[et("confirm"),{[A["b"]]:t.showCancelButton}],style:{color:t.confirmButtonColor},loading:o.confirm,onClick:u},null)]),j=()=>Object(c["l"])($,{class:et("footer")},{default:()=>[t.showCancelButton&&Object(c["l"])(Z,{type:"warning",text:t.cancelButtonText||nt("cancel"),class:et("cancel"),color:t.cancelButtonColor,loading:o.cancel,onClick:i},null),t.showConfirmButton&&Object(c["l"])(Z,{type:"danger",text:t.confirmButtonText||nt("confirm"),class:et("confirm"),color:t.confirmButtonColor,loading:o.confirm,onClick:u},null)]}),f=()=>n.footer?n.footer():"round-button"===t.theme?j():O();return()=>{var{width:e,title:n,theme:o,message:l,className:r}=t;return Object(c["l"])(q["a"],Object(c["s"])({role:"dialog",class:[et([o]),r],style:{width:Object(F["b"])(e)},"aria-labelledby":n||l,"onUpdate:show":a},Object(P["e"])(t,ct)),{default:()=>[s(),d(),f()]})}}});function at(){var t={setup(){var{state:t,toggle:e}=Object(U["b"])();return()=>Object(c["l"])(ot,Object(c["s"])(t,{"onUpdate:show":e}),null)}};({instance:S}=Object(U["a"])(t))}function lt(t){return P["c"]?new Promise((e,n)=>{S||at(),S.open(Object(P["a"])({},lt.currentOptions,t,{callback:t=>{("confirm"===t?e:n)(t)}}))}):Promise.resolve()}lt.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1},lt.currentOptions=Object(P["a"])({},lt.defaultOptions),lt.alert=lt,lt.confirm=t=>lt(Object(P["a"])({showCancelButton:!0},t)),lt.close=()=>{S&&S.toggle(!1)},lt.setDefaultOptions=t=>{Object(P["a"])(lt.currentOptions,t)},lt.resetDefaultOptions=()=>{lt.currentOptions=Object(P["a"])({},lt.defaultOptions)},lt.Component=Object(N["a"])(ot),lt.install=t=>{t.use(lt.Component),t.config.globalProperties.$dialog=lt};var rt=lt,it=(n("e7e5"),n("d399")),ut=(n("159b"),n("a7ac")),st=n("e05b"),bt=n("6c02"),dt={name:"OrderDetail",components:{NavBar:ut["a"]},setup:function(){var t=Object(bt["c"])(),e=Object(bt["d"])(),n=Object(c["G"])({orderNo:"",detail:{orderDetails:{data:[]},status:0},showPay:!1,aliyun:"",wechat:""}),o=function(){var e=t.query.id;n.orderNo=e,Object(st["c"])(e).then((function(t){console.log(t),n.detail=t}))};Object(c["z"])((function(){it["a"].loading({message:"加载中...",forbidClick:!0}),o(),it["a"].clear()}));var a=Object(c["e"])((function(){var t=["","已下单","已支付","等待发货","确认收货","已过期"];return t[n.detail.status]})),l=Object(c["e"])((function(){var t=0;return n.detail.orderDetails.data.forEach((function(e){t+=e.num*e.price})),t})),r=function(){n.showPay=!0,Object(st["f"])(n.orderNo,{type:"aliyun"}).then((function(t){n.aliyun=t.qr_code_url,n.wechat=t.qr_code_url}));var t=setInterval((function(){Object(st["g"])(n.orderNo).then((function(c){console.log(c),"2"==c&&(clearInterval(t),n.showPay=!1,e.push({path:"/orderdetail",query:{id:n.orderNo}}))}))}),2e3)},i=function(){rt.confirm({title:"是否确认订单"}).then((function(){Object(st["a"])(n.orderNo).then((function(t){Object(it["a"])("确认成功"),o()}))})).catch((function(){}))},u=function(){rt.close()};return Object(_["a"])(Object(_["a"])({},Object(c["P"])(n)),{},{statusString:a,total:l,showPayFn:r,handleConfirmOrder:i,close:u})}},Ot=(n("6d00"),n("6b0d")),jt=n.n(Ot);const ft=jt()(dt,[["render",x],["__scopeId","data-v-03435415"]]);e["default"]=ft},"6d00":function(t,e,n){"use strict";n("e384")},d4ef:function(t,e,n){},e05b:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return l})),n.d(e,"g",(function(){return r})),n.d(e,"d",(function(){return i})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return s}));var c=n("1bab");function o(t){return Object(c["a"])({url:"/api/orders",method:"post",params:t})}function a(){return Object(c["a"])({url:"/api/orders/preview"})}function l(t,e){return Object(c["a"])({url:"/api/orders/".concat(t,"/pay"),params:e})}function r(t){return Object(c["a"])({url:"/api/orders/".concat(t,"/status")})}function i(t){return Object(c["a"])({url:"/api/orders",method:"get",params:t})}function u(t){return Object(c["a"])({url:"/api/orders/".concat(t),params:{include:"user,orderDetails.goods"}})}function s(t){return Object(c["a"])({url:"/api/orders/".concat(t,"/confirm"),method:"patch"})}},e384:function(t,e,n){}}]);
//# sourceMappingURL=chunk-b6f94382.7010124e.js.map